```
from winsdk.windows.ui.notifications.management import UserNotificationListener

from winsdk.windows.ui.notifications import KnownNotificationBindings

  

def handler(asd, aasd):

    unotification = asd.get_notification(aasd.user_notification_id)

    # print(dir(unotification))

    if hasattr(unotification, "app_info"):

        print("App Name: ", unotification.app_info.display_info.display_name)

        text_sequence = unotification.notification.visual.get_binding(KnownNotificationBindings.get_toast_generic()).get_text_elements()

  

        it = iter(text_sequence)

        print("Notification title: ", it.current.text)

        while True:

            next(it, None)

            if it.has_current:

                print(it.current.text)

            else:

                break            

    else:

        pass

  

listener = UserNotificationListener.current

listener.add_notification_changed(handler)

  

while True: pass


```